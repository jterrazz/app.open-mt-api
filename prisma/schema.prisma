// Client settings

generator client {
    provider =        "prisma-client-js"
    previewFeatures = ["interactiveTransactions"]
}

datasource db {
    provider =        "postgresql"
    url =             env("DATABASE_URL")
}

// Enums

enum Language {
    FR
    EN
}

enum Currency {
    EUR
    USD
}

// Models

model User {
    id                Int             @id @default(autoincrement())
    email             String          @unique
    hashedPassword    String
    firstName          String
    lastName          String
    handle            String          @unique

    // External references
    avatarImage       Image?          @relation(fields: [avatarImageId], references: [id])
    avatarImageId     Int?            @unique
    userSettings      UserSettings    @relation(fields: [userSettingsId], references: [id])
    userSettingsId    Int             @unique
    shop              Shop?
}

model UserSettings {
    id                Int             @id @default(autoincrement())
    language          Language
    user              User?
}

model Product {
    id                Int             @id @default(autoincrement())
    name              String
    description       String?
    priceCentsAmount  Int
    priceCurrency     Currency

    // External references
    shop              Shop            @relation(fields: [shopId], references: [id])
    shopId            Int
}

model Shop {
    id                Int             @id @default(autoincrement())
    createdAt         DateTime        @default(now())
    handle            String          @unique
    name              String
    description       String?
    countOfFollowers  Int

    // External references
    products          Product[]

    // External references
    bannerImage       Image?          @relation(fields: [bannerImageId], references: [id])
    bannerImageId     Int?
    user              User            @relation(fields: [userId], references: [id])
    userId            Int             @unique
}

model Image {
    id                Int             @id @default(autoincrement())
    filename           String          @unique

    // External references
    user              User?
    shop              Shop?
}